id,vulnerability_name,severity,cwe_code,location,verdict,explanation
1,"App runs in debug mode",Low,CWE-489,sqli/app.py:24,TRUE POSITIVE,"O modo de depuração está explicitamente habilitado no código (debug=True), o que é inseguro para um ambiente de produção, pois pode expor informações sensíveis."
2,"Autoescape Disabled in Jinja2",High,CWE-79,src/dvpwa/sqli/app.py:35,TRUE POSITIVE,"O autoescape do Jinja2 está explicitamente desabilitado (autoescape=False), tornando a aplicação vulnerável a ataques de Cross-Site Scripting (XSS) por design."
3,"CSRF middleware disabled globally",High,CWE-352,sqli/app.py:25-29,TRUE POSITIVE,"O middleware de proteção contra Cross-Site Request Forgery (CSRF) está comentado no código-fonte, desativando essa importante camada de segurança para toda a aplicação."
4,"Cross-Site Request Forgery (CSRF)",HIGH,N/A,sqli/app.py:27,TRUE POSITIVE,"A ausência do middleware CSRF torna a aplicação vulnerável a ataques de CSRF, onde um atacante pode forçar um usuário autenticado a executar ações indesejadas."
5,"Cross-Site Scripting (XSS)",HIGH,CWE-79,sqli/app.py:28,TRUE POSITIVE,"A combinação da desativação do autoescape do Jinja2 e a falta de validação/sanitização de entradas torna a aplicação vulnerável a ataques de XSS."
6,"Cross-Site Scripting (XSS) via course description",High,CWE-79,src/dvpwa/sqli/templates/course.jinja2:15,TRUE POSITIVE,"A descrição do curso é renderizada diretamente no template sem qualquer tipo de escape, permitindo a execução de scripts maliciosos inseridos neste campo."
7,"Cross-Site Scripting (XSS) via course description in list",High,CWE-79,src/dvpwa/sqli/templates/courses.jinja2:18,TRUE POSITIVE,"Similar à vulnerabilidade anterior, a descrição do curso na lista de cursos também é renderizada sem escape, criando outro vetor para ataques de XSS."
8,"Cross-Site Scripting (XSS) via course description in student results",High,CWE-79,src/dvpwa/sqli/templates/student.jinja2:20,TRUE POSITIVE,"A descrição do curso nos resultados do estudante é mais um ponto onde a falta de escape permite a execução de scripts, explorando a mesma falha de XSS."
9,"Cross-Site Scripting (XSS) via course title",High,CWE-79,src/dvpwa/sqli/templates/course.jinja2:14,TRUE POSITIVE,"O título do curso é renderizado sem escape, permitindo a injeção de scripts maliciosos que serão executados no navegador de outros usuários."
10,"Cross-Site Scripting (XSS) via course title in list",High,CWE-79,src/dvpwa/sqli/templates/courses.jinja2:17,TRUE POSITIVE,"O título do curso na lista de cursos é renderizado sem escape, abrindo uma vulnerabilidade de XSS que afeta a visualização de múltiplos cursos."
11,"Cross-Site Scripting (XSS) via course title in review form",High,CWE-79,src/dvpwa/sqli/templates/review.jinja2:32,TRUE POSITIVE,"O título do curso no formulário de avaliação é renderizado sem escape, permitindo que um título de curso malicioso execute scripts na página de avaliação."
12,"Cross-Site Scripting (XSS) via course title in student results",High,CWE-79,src/dvpwa/sqli/templates/student.jinja2:19,TRUE POSITIVE,"O título do curso nos resultados do estudante é renderizado sem escape, criando outra oportunidade para a execução de scripts maliciosos."
13,"Cross-Site Scripting (XSS) via review text",High,CWE-79,src/dvpwa/sqli/templates/course.jinja2:22,TRUE POSITIVE,"O texto da avaliação é renderizado diretamente no template, permitindo que um usuário mal-intencionado insira scripts que serão executados por outros usuários que visualizarem a avaliação."
14,"Cross-Site Scripting (XSS) via student name in list",High,CWE-79,src/dvpwa/sqli/templates/students.jinja2:16,TRUE POSITIVE,"O nome do estudante na lista de estudantes é renderizado sem escape, permitindo a execução de scripts maliciosos através de nomes de estudantes criados para esse fim."
15,"Debug Mode Enabled",LOW,N/A,sqli/app.py:24,TRUE POSITIVE,"O modo de depuração está habilitado, o que é uma repetição da vulnerabilidade de ID 1 e representa um risco de segurança em produção."
16,"Disabled Jinja autoescape enables XSS",High,CWE-79,sqli/app.py:33-35,TRUE POSITIVE,"Esta é uma reiteração da vulnerabilidade de ID 2, confirmando que a desativação do autoescape é a causa raiz de múltiplas vulnerabilidades de XSS."
17,"Docker Security Misconfigurations",LOW,CWE-732,docker-compose.yml:11,TRUE POSITIVE,"O arquivo docker-compose.yml não segue as melhores práticas de segurança, como a falta de 'no-new-privileges' e 'read_only', o que pode facilitar a escalada de privilégios."
18,"Hardcoded Credentials",MEDIUM,CWE-798,config/dev.yaml,TRUE POSITIVE,"O arquivo de configuração de desenvolvimento contém credenciais de banco de dados codificadas diretamente no arquivo, o que é uma má prática de segurança."
19,"Hardcoded database credentials",Medium,CWE-798,config/dev.yaml:1-7,TRUE POSITIVE,"Repetição da vulnerabilidade de ID 18, as credenciais do banco de dados estão expostas no arquivo de configuração, facilitando o acesso não autorizado."
20,"Insecure Format Strings",INFO,CWE-134,"sqli/static/js/materialize.js:645;661;699",FALSE POSITIVE,"Esta vulnerabilidade foi identificada em um arquivo de biblioteca de terceiros (materialize.js), não no código da aplicação DVPWA. Portanto, é um falso positivo no contexto da análise do código customizado."
21,"Insecure Password Hashing",High,CWE-327,src/dvpwa/sqli/dao/user.py:40,TRUE POSITIVE,"A aplicação utiliza o algoritmo MD5 para hashing de senhas, que é considerado inseguro e vulnerável a ataques de colisão e rainbow table."
22,"Missing Authorization Checks",MEDIUM,N/A,Multiple endpoints,TRUE POSITIVE,"Diversos endpoints da aplicação não realizam verificações de autorização adequadas, permitindo que usuários não autorizados acessem ou modifiquem dados."
23,"Missing Authorization for student evaluation",High,CWE-862,src/dvpwa/sqli/views.py:135,TRUE POSITIVE,"A funcionalidade de avaliação de estudantes não possui uma verificação de autorização, permitindo que qualquer usuário, mesmo não autenticado, submeta avaliações."
24,"Missing CSRF Protection",HIGH,CWE-352,sqli/app.py:22,TRUE POSITIVE,"A falta de proteção CSRF é uma vulnerabilidade crítica que permite a um atacante enganar a vítima para que ela execute ações não intencionais na aplicação."
25,"Missing CSRF Protection",High,CWE-352,src/dvpwa/sqli/app.py:27,TRUE POSITIVE,"Esta é uma repetição da vulnerabilidade de ID 24, confirmando a ausência de proteção CSRF em toda a aplicação devido ao middleware desabilitado."
26,"Missing HTTP security headers (CSP, X-Frame-Options)",Medium,CWE-693,sqli/app.py:23-40,TRUE POSITIVE,"A aplicação não implementa cabeçalhos de segurança HTTP importantes como Content-Security-Policy (CSP) e X-Frame-Options, o que a torna mais suscetível a ataques de clickjacking e XSS."
27,"Missing authorization on POST /courses/",High,CWE-285,sqli/views.py:86-91,TRUE POSITIVE,"O endpoint para criação de cursos não possui verificação de autorização, permitindo que qualquer usuário crie novos cursos na plataforma."
28,"Missing authorization on POST /students/",Medium,CWE-285,sqli/views.py:54-58,TRUE POSITIVE,"O endpoint para criação de estudantes não possui verificação de autorização, permitindo que qualquer usuário adicione novos estudantes ao sistema."
29,"Missing authorization on POST evaluate",High,CWE-285,sqli/views.py:134-153,TRUE POSITIVE,"O endpoint de avaliação não possui autorização, permitindo que qualquer usuário envie avaliações para qualquer estudante em qualquer curso."
30,"No Rate Limiting",MEDIUM,N/A,sqli/views.py:33-45,TRUE POSITIVE,"A ausência de limitação de taxa (rate limiting) no endpoint de login torna a aplicação vulnerável a ataques de força bruta nas credenciais dos usuários."
31,"No brute-force protection or rate limiting on login",Low,CWE-307,sqli/views.py:33-46,TRUE POSITIVE,"Esta é uma repetição da vulnerabilidade de ID 30, confirmando a falta de proteção contra ataques de força bruta no mecanismo de autenticação."
32,"Outdated and Vulnerable Dependencies",HIGH,CWE-937,requirements.txt,TRUE POSITIVE,"O arquivo requirements.txt lista dependências com versões antigas que possuem vulnerabilidades conhecidas. Dado o propósito do projeto, é provável que isso seja intencional."
33,"Plain MD5 password hashing",High,CWE-327,sqli/dao/user.py:40-41,TRUE POSITIVE,"A utilização de MD5 para hashing de senhas é uma prática insegura, pois é um algoritmo rápido e suscetível a ataques de força bruta e rainbow tables."
34,"Possible SQL injection vector through string-based query construction.",MEDIUM,CWE-89,sqli/dao/student.py:42,TRUE POSITIVE,"A construção de consultas SQL através da concatenação de strings é uma prática perigosa que abre uma brecha para ataques de injeção de SQL."
35,"Regular Expression DoS (ReDoS)",LOW,CWE-1333,sqli/static/js/materialize.js:565,FALSE POSITIVE,"A vulnerabilidade de ReDoS foi encontrada em um arquivo de biblioteca de terceiros (materialize.js), não no código da aplicação. Portanto, é um falso positivo no contexto da análise do código customizado."
36,"SQL Injection",CRITICAL,CWE-89,sqli/dao/student.py:42-45,TRUE POSITIVE,"A aplicação é vulnerável a injeção de SQL na funcionalidade de criação de estudantes, permitindo que um atacante execute comandos SQL arbitrários no banco de dados."
37,"SQL Injection",CRITICAL,CWE-89,sqli/dao/student.py:45,TRUE POSITIVE,"Esta é uma repetição da vulnerabilidade de ID 36, confirmando a presença de uma falha crítica de injeção de SQL que pode levar ao comprometimento total do banco de dados."
38,"SQL Injection",High,CWE-89,src/dvpwa/sqli/dao/student.py:42,TRUE POSITIVE,"A vulnerabilidade de injeção de SQL permite a manipulação de consultas ao banco de dados, podendo resultar em vazamento de dados, bypass de autenticação e execução remota de código."
39,"SQL injection via string formatting in Student.create",High,CWE-89,sqli/dao/student.py:42-45,TRUE POSITIVE,"O uso de formatação de string para inserir dados do usuário diretamente em uma consulta SQL é a causa da vulnerabilidade de injeção de SQL."
40,"Service 'redis' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.",WARNING,CWE-732,docker-compose.yml:11,TRUE POSITIVE,"A configuração do serviço Redis no docker-compose.yml permite a escalada de privilégios. A adição de 'no-new-privileges:true' mitigaria esse risco."
41,"Service 'redis' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.",WARNING,CWE-732,docker-compose.yml:11,TRUE POSITIVE,"O sistema de arquivos do contêiner Redis é gravável, o que representa um risco de segurança. Torná-lo somente leitura ('read_only: true') aumentaria a segurança do contêiner."
42,"Session Fixation",HIGH,N/A,"sqli/views.py:42; sqli/middlewares.py:20",TRUE POSITIVE,"A aplicação não regenera o ID da sessão após o login, tornando-a vulnerável a ataques de fixação de sessão, onde um atacante pode sequestrar a sessão de um usuário."
43,"Session cookie missing HttpOnly",High,CWE-1004,sqli/middlewares.py:20-22,TRUE POSITIVE,"O cookie de sessão não possui a flag HttpOnly, o que o torna acessível a scripts do lado do cliente e aumenta o risco de roubo de sessão através de ataques XSS."
44,"Session cookie missing Secure attribute",Medium,CWE-614,sqli/middlewares.py:20-22,TRUE POSITIVE,"O cookie de sessão não possui a flag Secure, o que permite que ele seja transmitido em conexões não criptografadas (HTTP), expondo-o a ataques de sniffing."
45,"Stored Cross-Site Scripting (XSS)",HIGH,CWE-79,"sqli/app.py:35; sqli/views.py:121-129",TRUE POSITIVE,"A aplicação é vulnerável a XSS armazenado, onde scripts maliciosos são salvos no banco de dados e executados sempre que a página vulnerável é carregada."
46,"Unescaped user content in templates (course and reviews)",Medium,CWE-79,sqli/templates/course.jinja2:14-23,TRUE POSITIVE,"O conteúdo do usuário nos templates de curso e avaliações não é escapado, o que é a causa raiz de várias vulnerabilidades de XSS na aplicação."
47,"Use of weak MD5 hash for security. Consider usedforsecurity=False",HIGH,CWE-327,sqli/dao/user.py:41,TRUE POSITIVE,"O uso de MD5 para segurança é fortemente desaconselhado. A aplicação deveria usar algoritmos de hashing de senha mais robustos como Argon2, bcrypt ou PBKDF2."
48,"Weak Password Hashing",HIGH,CWE-327,sqli/dao/user.py:45,TRUE POSITIVE,"A utilização de um algoritmo de hashing fraco para senhas é uma vulnerabilidade crítica que pode levar ao comprometimento de todas as contas de usuário."
49,"Weak Password Hashing (MD5)",HIGH,CWE-327,sqli/dao/user.py:41,TRUE POSITIVE,"Esta é uma repetição da vulnerabilidade de hashing de senha fraco, enfatizando o risco associado ao uso de MD5 para proteger as senhas dos usuários."
50,"yaml.docker-compose.security.no-new-privileges.no-new-privileges",WARNING,CWE-732,docker-compose.yml:11,TRUE POSITIVE,"A falta da opção de segurança 'no-new-privileges' no docker-compose.yml é uma falha de configuração que pode permitir a escalada de privilégios dentro do contêiner."

